{"version":3,"sources":["webpack:///webpack/bootstrap cb6ee85292929ec95e79","webpack:///./src/index.js","webpack:///./src/vector.js","webpack:///./src/objects/index.js","webpack:///./src/objects/sphere.js","webpack:///./src/objects/geometric-object.js","webpack:///./src/renderer.js","webpack:///./src/ray.js"],"names":["canvas","document","getElementById","width","height","style","cssText","renderer","progress","scene","camera","point","fieldOfView","direction","lights","objects","center","radius","color","material","specular","lambert","ambient","Math","sin","cos","play","Vector","x","y","z","v","t","sqrt","dot","mag","div","d","copy","sub","amount","n","normalize","mult","max","magSq","setMag","atan2","angle","newHeading","heading","a","b","cross","add","dist","lerp","acos","normal","Sphere","ray","eyeToCenter","origin","eoDot","discriminant","pos","GeometricObject","undefined","DEFAULT_TRACE_DEPTH_LIMIT","DEFAULT_SCENE","Renderer","generateSceneCallback","context","getContext","data","getImageData","generateScene","traceDepthLimit","isPlaying","startTime","eyeVector","vpRight","UP","vpUp","fovRadians","PI","heightWidthRatio","halfWidth","tan","halfHeight","cameraWidth","cameraHeight","pixelWidth","pixelHeight","xComp","yComp","trace","index","putImageData","depth","intersectScene","object","Infinity","pointAtTime","surface","calculateNormal","reduce","closest","calculateIntersection","ZERO","lambertAmount","forEach","isLightVisible","lightPoint","contribution","reflectedRay","reflectThrough","reflectedColor","min","light","timestamp","render","requestAnimationFrame","tick","bind","Ray","r"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cb6ee85292929ec95e79","import Vector from './vector'\nimport { Sphere } from './objects'\nimport Renderer from './renderer'\n\nconst canvas = document.getElementById('canvas')\nconst width = 640 * 0.5\nconst height = 480 * 0.5\n\ncanvas.width = width\ncanvas.height = height\ncanvas.style.cssText = `width:${(width * 2)}px;height:${(height * 2)}px`\n\nconst renderer = new Renderer(canvas, function (progress) {\n  progress *= 0.001\n\n  const scene = {\n    camera: {\n      point: new Vector(0.0, 1.8, 10),\n      fieldOfView: 45,\n      direction: new Vector(0.0, 3.0, 0.0)\n    },\n    lights: [new Vector(-30, -10, 20)],\n    objects: [\n      new Sphere({\n        center: new Vector(0, 3.5, -3),\n        radius: 3,\n        color: new Vector(155, 200, 155),\n        material: {\n          specular: 0.2,\n          lambert: 0.7,\n          ambient: 0.1\n        }\n      }),\n      new Sphere({\n        center: new Vector(Math.sin(progress * 0.1) * 3.5, 2, -3 + (Math.cos(progress * 0.1) * 3.5)),\n        radius: 0.2,\n        color: new Vector(155, 155, 155),\n        material: {\n          specular: 0.1,\n          lambert: 0.9,\n          ambient: 0.0\n        }\n      }),\n      new Sphere({\n        center: new Vector(Math.sin(progress * 0.2) * 4, 3, -3 + (Math.cos(progress * 0.2) * 4)),\n        radius: 0.1,\n        color: new Vector(255, 255, 255),\n        material: {\n          specular: 0.2,\n          lambert: 0.7,\n          ambient: 0.1\n        }\n      })\n    ]\n  }\n\n  return scene\n})\n\nrenderer.play()\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*\n * Heavily cribbed from:\n *   https://github.com/processing/p5.js/blob/master/src/math/p5.Vector.js\n *   https://github.com/tmcw/literate-raytracer/blob/gh-pages/vector.js\n */\n\nexport default class Vector {\n  constructor(x = 0, y = 0, z = 0) {\n    this.x = x\n    this.y = y\n    this.z = z\n  }\n\n  static get UP() {\n    return new Vector(0.0, 1.0, 0.0)\n  }\n\n  static get ZERO() {\n    return new Vector(0.0, 0.0, 0.0)\n  }\n\n  static dot(a, b) {\n    return a.dot(b)\n  }\n\n  static cross(a, b) {\n    return a.cross(b)\n  }\n\n  static mult(a, t) {\n    return a.copy().mult(t)\n  }\n\n  static div(a, t) {\n    return a.copy().div(t)\n  }\n\n  static mag(a) {\n    return a.mag()\n  }\n\n  static normalize(a) {\n    return Vector.div(a, Vector.mag(a))\n  }\n\n  static add(a, b) {\n    return a.copy().add(b)\n  }\n\n  static sub(a, b) {\n    return a.copy().sub(b)\n  }\n\n  static dist(a, b) {\n    return a.dist(b)\n  }\n\n  static lerp(a, b, amount) {\n    return a.copy().lerp(b, amount)\n  }\n\n  static angleBetween(a, b) {\n    return Math.acos(a.dot(b) / (a.mag() * b.mag())) // in radians\n  }\n\n  static reflectThrough(a, normal) {\n    const d = Vector.mult(normal, Vector.dot(a, normal))\n    return Vector.sub(Vector.mult(d, 2), a)\n  }\n\n  copy() {\n    return new Vector(this.x, this.y, this.z)\n  }\n\n  set(x = 0, y = 0, z = 0) {\n    if (x instanceof Vector) {\n      this.x = x.x || 0\n      this.y = x.y || 0\n      this.z = x.z || 0\n      return this\n    }\n\n    this.x = x\n    this.y = y\n    this.z = z\n    return this\n  }\n\n  dot(v) {\n    return (this.x * (v.x || 0)) + (this.y * (v.y || 0)) + (this.z * (v.z || 0))\n  }\n\n  cross(v) {\n    return new Vector(\n      (this.y * v.z) - (this.z * v.y),\n      (this.z * v.x) - (this.x * v.z),\n      (this.x * v.y) - (this.y * v.x)\n    )\n  }\n\n  mult(t = 0) {\n    this.x *= t\n    this.y *= t\n    this.z *= t\n    return this\n  }\n\n  div(t) {\n    this.x /= t\n    this.y /= t\n    this.z /= t\n    return this\n  }\n\n  mag() {\n    return Math.sqrt(this.dot(this))\n  }\n\n  normalize() {\n    return this.mag() === 0 ? this : this.div(this.mag())\n  }\n\n  add(v) {\n    this.x += v.x || 0\n    this.y += v.y || 0\n    this.z += v.z || 0\n    return this\n  }\n\n  sub(v) {\n    this.x -= v.x || 0\n    this.y -= v.y || 0\n    this.z -= v.z || 0\n    return this\n  }\n\n  dist(v) {\n    const d = v.copy().sub(this)\n    return d.mag()\n  }\n\n  equals(v) {\n    return this.x === v.x && this.y === v.y && this.z === v.z\n  }\n\n  lerp(v, amount) {\n    this.x += (v.x - this.x) * amount || 0\n    this.y += (v.y - this.y) * amount || 0\n    this.z += (v.z - this.z) * amount || 0\n    return this\n  }\n\n  setMag(n) {\n    return this.normalize().mult(n)\n  }\n\n  limit(max) {\n    const magSq = this.dot(this)\n    if (magSq > max * max) {\n      this.setMag(max)\n    }\n    return this\n  }\n\n  heading() {\n    return Math.atan2(this.y, this.x) // in radians\n  }\n\n  rotate(angle) {\n    const newHeading = this.heading() + angle\n    const mag = this.mag()\n    this.x = Math.cos(newHeading) * mag\n    this.y = Math.sin(newHeading) * mag\n    return this\n  }\n\n  toString() {\n    return `[${this.x}, ${this.y}, ${this.z}]`\n  }\n\n  toArray() {\n    return [this.x, this.y, this.z]\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/vector.js","import Sphere from './sphere'\n\nexport {\n  Sphere\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/objects/index.js","import GeometricObject from './geometric-object'\nimport Vector from '../vector'\n\nexport default class Sphere extends GeometricObject {\n  constructor({ center, radius, color, material }) {\n    super(color, material)\n    this.center = center\n    this.radius = radius\n  }\n\n  calculateIntersection(ray) {\n    const eyeToCenter = Vector.sub(this.center, ray.origin)\n    const v = Vector.dot(eyeToCenter, ray.direction)\n    const eoDot = Vector.dot(eyeToCenter, eyeToCenter)\n    const discriminant = (this.radius * this.radius) - eoDot + (v * v)\n\n    if (discriminant < 0) {\n      return\n    }\n\n    return v - Math.sqrt(discriminant)\n  }\n\n  calculateNormal(pos) {\n    return Vector.normalize(Vector.sub(pos, this.center))\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/objects/sphere.js","export default class GeometricObject {\n  constructor(color, material) {\n    this.color = color\n    this.material = material\n  }\n\n  calculateIntersection() {\n    return undefined\n  }\n\n  calculateNormal() {\n    return undefined\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/objects/geometric-object.js","import Vector from './vector'\nimport Ray from './ray'\n\nconst DEFAULT_TRACE_DEPTH_LIMIT = 3\nconst DEFAULT_SCENE = {\n  camera: {\n    point: new Vector(0.0, 0.0, 0.0),\n    fieldOfView: 45,\n    direction: new Vector(0.0, 0.0, 0.0)\n  },\n  lights: [],\n  objects: []\n}\n\nexport default class Renderer {\n  constructor(canvas, generateSceneCallback = () => DEFAULT_SCENE) {\n    const { width, height } = canvas\n\n    this.canvas = canvas\n    this.context = canvas.getContext('2d')\n    this.data = this.context.getImageData(0, 0, width, height)\n    this.generateScene = generateSceneCallback\n    this.traceDepthLimit = DEFAULT_TRACE_DEPTH_LIMIT\n    this.isPlaying = false\n    this.startTime = null\n  }\n\n  render(scene) {\n    const camera = scene.camera\n    const { width, height } = this.canvas\n\n    // all the raytracing stuff goes here\n\n    const eyeVector = Vector.normalize(Vector.sub(camera.direction, camera.point))\n    const vpRight = Vector.normalize(Vector.cross(eyeVector, Vector.UP))\n    const vpUp = Vector.normalize(Vector.cross(vpRight, eyeVector))\n\n    const fovRadians = Math.PI * (camera.fieldOfView / 2) / 180\n    const heightWidthRatio = height / width\n    const halfWidth = Math.tan(fovRadians)\n    const halfHeight = heightWidthRatio * halfWidth\n    const cameraWidth = halfWidth * 2\n    const cameraHeight = halfHeight * 2\n    const pixelWidth = cameraWidth / (width - 1)\n    const pixelHeight = cameraHeight / (height - 1)\n\n    const ray = new Ray(camera.point)\n    for (let x = 0; x < width; x++) {\n      for (let y = 0; y < height; y++) {\n        // turn the raw pixel x and y values into values from -1 to 1\n        // and use these values to scale the facing-right and facing-up\n        // vectors so that we generate versions of the `eyeVector` that are\n        // skewed in each necessary direction.\n        const xComp = Vector.mult(vpRight, (x * pixelWidth) - halfWidth)\n        const yComp = Vector.mult(vpUp, (y * pixelHeight) - halfHeight)\n\n        ray.direction = Vector.normalize(Vector.add(eyeVector, Vector.add(xComp, yComp)))\n\n        const color = this.trace(ray, scene, 0)\n        const index = (x * 4) + (y * width * 4)\n        this.data.data[index + 0] = color.x\n        this.data.data[index + 1] = color.y\n        this.data.data[index + 2] = color.z\n        this.data.data[index + 3] = 255\n      }\n    }\n\n    this.context.putImageData(this.data, 0, 0)\n  }\n\n  trace(ray, scene, depth) {\n    if (depth > this.traceDepthLimit) {\n      return\n    }\n\n    const [dist, object] = this.intersectScene(ray, scene)\n\n    if (dist === Infinity) {\n      return new Vector(255, 255, 255)\n    }\n\n    // The pointAtTime is another way of saying the 'intersection point'\n    // of this ray into this object. We compute this by simply taking\n    // the direction of the ray and making it as long as the distance\n    // returned by the intersection check.\n    const pointAtTime = Vector.add(ray.origin, Vector.mult(ray.direction, dist))\n\n    return this.surface(ray, scene, object, pointAtTime, object.calculateNormal(pointAtTime), depth)\n  }\n\n  intersectScene(ray, scene) {\n    return scene.objects.reduce(function (closest, object) {\n      const dist = object.calculateIntersection(ray)\n      return dist !== undefined && dist < closest[0] ? [dist, object] : closest\n    }, [Infinity, null])\n  }\n\n  surface(ray, scene, object, pointAtTime, normal, depth) {\n    let color = Vector.ZERO\n    let lambertAmount = 0\n\n    if (object.material.lambert) {\n      scene.lights.forEach(lightPoint => {\n        // First: can we see the light? If not, this is a shadowy area\n        // and it gets no light from the lambert shading process.\n        if (!this.isLightVisible(pointAtTime, scene, lightPoint)) {\n          return\n        }\n        // Otherwise, calculate the lambertian reflectance, which\n        // essentially is a 'diffuse' lighting system - direct light\n        // is bright, and from there, less direct light is gradually,\n        // beautifully, less light.\n        const contribution = Vector.dot(Vector.normalize(Vector.sub(lightPoint, pointAtTime)), normal)\n        // sometimes this formula can return negatives, so we check:\n        // we only want positive values for lighting.\n        if (contribution > 0) {\n          lambertAmount += contribution\n        }\n      })\n    }\n\n    if (object.material.specular) {\n      // This is basically the same thing as what we did in render(), just\n      // instead of looking from the viewpoint of the camera, we're looking\n      // from a point on the surface of a shiny object, seeing what it sees\n      // and making that part of a reflection.\n      const reflectedRay = new Ray(pointAtTime, Vector.reflectThrough(ray.direction, normal))\n      const reflectedColor = this.trace(reflectedRay, scene, depth + 1)\n      if (reflectedColor) {\n        color = Vector.add(color, Vector.mult(reflectedColor, object.material.specular))\n      }\n    }\n\n    // lambert should never 'blow out' the lighting of an object,\n    // even if the ray bounces between a lot of things and hits lights\n    lambertAmount = Math.min(1, lambertAmount)\n\n    // Ambient colors shine bright regardless of whether there's a light visible -\n    // a circle with a totally ambient blue color will always just be a flat blue\n    // circle.\n    return Vector.add(\n      Vector.add(\n        color,\n        Vector.mult(object.color, lambertAmount * object.material.lambert)\n      ),\n      Vector.mult(object.color, object.material.ambient)\n    )\n  }\n\n  isLightVisible(point, scene, light) {\n    const [dist] = this.intersectScene(new Ray(point, Vector.normalize(Vector.sub(point, light))), scene)\n    return dist > -0.005\n  }\n\n  tick(timestamp) {\n    if (!this.startTime) {\n      this.startTime = timestamp\n    }\n\n    const progress = timestamp - this.startTime\n    const scene = this.generateScene(progress)\n\n    this.render(scene)\n\n    if (this.isPlaying) {\n      requestAnimationFrame(this.tick.bind(this))\n    }\n  }\n\n  play() {\n    this.isPlaying = true\n    requestAnimationFrame(this.tick.bind(this))\n  }\n\n  stop() {\n    this.isPlaying = false\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/renderer.js","import Vector from './vector'\n\nexport default class Ray {\n  constructor(origin = new Vector(0, 0, 0), direction = new Vector(0, 0, 1.0)) {\n    if (origin instanceof Ray) {\n      origin = origin.origin\n      direction = origin.direction\n    }\n    this.origin = origin\n    this.direction = direction\n  }\n\n  set(r) {\n    this.origin = r.origin,\n    this.direction = r.direction\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ray.js"],"sourceRoot":""}